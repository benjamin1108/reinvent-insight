# TTS åŠŸèƒ½å®ç°æ€»ç»“

## é¡¹ç›®çŠ¶æ€

âœ… **å·²å®Œæˆ**: TTS åŠŸèƒ½å·²ä» Qwen æˆåŠŸè¿ç§»åˆ° Geminiï¼Œæ ¸å¿ƒåŠŸèƒ½æ­£å¸¸å·¥ä½œ

## å®Œæˆçš„å·¥ä½œ

### 1. æµå¼æ’­æ”¾é—®é¢˜ä¿®å¤ âœ…
- **é—®é¢˜**: éŸ³é¢‘å—ä¸èƒ½è¿ç»­æ’­æ”¾ï¼Œåªæ’­æ”¾æœ€åä¸€æ®µ
- **è§£å†³**: ä¿®å¤äº† `AudioPlayer.js` çš„æµå¼æ’­æ”¾é€»è¾‘
- **æ–‡æ¡£**: `.kiro/specs/text-to-speech-player/BUGFIX-streaming.md`

### 2. Qwen â†’ Gemini è¿ç§» âœ…
- **åŸå› **: ç”¨æˆ·è¦æ±‚åˆ‡æ¢åˆ° Gemini TTS
- **å®Œæˆ**: å…¨é¢æ›¿æ¢ä¸º Gemini TTS API
- **æ–‡æ¡£**: `.kiro/specs/text-to-speech-player/MIGRATION-to-gemini.md`

## æŠ€æœ¯æ ˆ

### åç«¯
- **TTS æä¾›å•†**: Google Gemini
- **æ¨¡å‹**: `gemini-2.5-flash-preview-tts`
- **éŸ³é¢‘æ ¼å¼**: PCM 24kHz 16-bit â†’ WAV
- **ä¼ è¾“æ ¼å¼**: Base64 ç¼–ç 

### å‰ç«¯
- **æ’­æ”¾å™¨**: Web Audio API
- **æµå¼å¤„ç†**: Server-Sent Events (SSE)
- **ç¼“å†²ç®¡ç†**: StreamBuffer ç±»
- **UI æ¡†æ¶**: Vue 3

## æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°
1. **æ–‡æœ¬è½¬è¯­éŸ³**: æ”¯æŒä¸­æ–‡å’Œå¤šç§è¯­è¨€
2. **æµå¼æ’­æ”¾**: è¾¹ç”Ÿæˆè¾¹æ’­æ”¾ï¼ˆè™½ç„¶ Gemini è¿”å›å®Œæ•´æ•°æ®ï¼‰
3. **éŸ³é¢‘ç¼“å­˜**: LRU ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤ç”Ÿæˆ
4. **æ’­æ”¾æ§åˆ¶**: æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€è¿›åº¦è°ƒæ•´
5. **éŸ³è‰²é€‰æ‹©**: 30 ç§ Gemini éŸ³è‰²
6. **æ’­æ”¾é€Ÿåº¦**: 0.5x - 2x å¯è°ƒ
7. **éŸ³é‡æ§åˆ¶**: 0% - 100%
8. **ç”¨æˆ·åå¥½**: localStorage æŒä¹…åŒ–
9. **é”™è¯¯å¤„ç†**: å‹å¥½çš„é”™è¯¯æç¤º
10. **å“åº”å¼ UI**: ç§»åŠ¨ç«¯é€‚é…

### â³ å¾…å®ç°ï¼ˆä»»åŠ¡ 11-15ï¼‰
- [ ] ä»»åŠ¡ 11.2: éŸ³è‰²åˆ‡æ¢æµç¨‹ä¼˜åŒ–
- [ ] ä»»åŠ¡ 11.3: ç¼“å­˜å¤ç”¨æµç¨‹éªŒè¯
- [ ] ä»»åŠ¡ 12: è¿è¡Œæ‰€æœ‰æµ‹è¯•
- [ ] ä»»åŠ¡ 13: æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†å¢å¼º
- [ ] ä»»åŠ¡ 14: æ–‡æ¡£å’Œéƒ¨ç½²å‡†å¤‡
- [ ] ä»»åŠ¡ 15: æœ€ç»ˆéªŒè¯

## æ–‡ä»¶æ¸…å•

### é…ç½®æ–‡ä»¶
- `config/model_config.yaml` - æ¨¡å‹é…ç½®ï¼ˆå·²æ›´æ–°ä¸º Geminiï¼‰

### åç«¯ä»£ç 
- `src/reinvent_insight/model_config.py` - æ·»åŠ äº† GeminiClient TTS æ–¹æ³•
- `src/reinvent_insight/api.py` - TTS API ç«¯ç‚¹ï¼ˆå·²æ›´æ–°ï¼‰
- `src/reinvent_insight/services/tts_service.py` - TTS æœåŠ¡
- `src/reinvent_insight/services/audio_cache.py` - éŸ³é¢‘ç¼“å­˜
- `src/reinvent_insight/audio/audio_utils.py` - éŸ³é¢‘å·¥å…·

### å‰ç«¯ä»£ç 
- `web/utils/AudioPlayer.js` - éŸ³é¢‘æ’­æ”¾å™¨ï¼ˆå·²ä¿®å¤ï¼‰
- `web/utils/StreamBuffer.js` - æµå¼ç¼“å†²
- `web/components/shared/AudioControlBar/` - æ’­æ”¾æ§åˆ¶ç»„ä»¶ï¼ˆå·²æ›´æ–°éŸ³è‰²ï¼‰

### æµ‹è¯•æ–‡ä»¶
- `web/test/test-tts-streaming.html` - å‰ç«¯æµ‹è¯•é¡µé¢
- `tests/test_gemini_tts.py` - åç«¯æµ‹è¯•è„šæœ¬

### æ–‡æ¡£
- `.kiro/specs/text-to-speech-player/requirements.md` - éœ€æ±‚æ–‡æ¡£
- `.kiro/specs/text-to-speech-player/design.md` - è®¾è®¡æ–‡æ¡£
- `.kiro/specs/text-to-speech-player/tasks.md` - ä»»åŠ¡åˆ—è¡¨
- `.kiro/specs/text-to-speech-player/BUGFIX-streaming.md` - æµå¼æ’­æ”¾ä¿®å¤
- `.kiro/specs/text-to-speech-player/MIGRATION-to-gemini.md` - Gemini è¿ç§»
- `.kiro/specs/text-to-speech-player/SUMMARY.md` - æœ¬æ–‡æ¡£

## ä½¿ç”¨æ–¹æ³•

### 1. é…ç½®ç¯å¢ƒå˜é‡
```bash
export GEMINI_API_KEY="your-gemini-api-key-here"
```

### 2. å¯åŠ¨æœåŠ¡
```bash
# åç«¯
python src/reinvent_insight/main.py

# æˆ–ä½¿ç”¨å¼€å‘è„šæœ¬
./run-dev.sh
```

### 3. æµ‹è¯•åŠŸèƒ½

#### æ–¹å¼ 1: æµ‹è¯•é¡µé¢
```
http://localhost:8000/test/test-tts-streaming.html
```

#### æ–¹å¼ 2: ReadingView
```
http://localhost:8000
# æ‰“å¼€ä»»æ„æ–‡ç« ï¼Œç‚¹å‡»æ’­æ”¾æŒ‰é’®
```

#### æ–¹å¼ 3: åç«¯æµ‹è¯•
```bash
python tests/test_gemini_tts.py
```

## Gemini TTS ç‰¹æ€§

### éŸ³è‰²åˆ—è¡¨ï¼ˆ30ç§ï¼‰

| éŸ³è‰² | é£æ ¼ | éŸ³è‰² | é£æ ¼ |
|------|------|------|------|
| Zephyr | æ˜äº® | Autonoe | æ˜äº® |
| Puck | æ¬¢å¿« | Fenrir | å…´å¥‹ |
| Laomedeia | æ¬¢å¿« | Kore | åšå®š |
| Orus | åšå®š | Alnilam | åšå®š |
| Charon | çŸ¥æ€§ | Rasalgethi | çŸ¥æ€§ |
| Callirrhoe | éšå’Œ | Umbriel | éšå’Œ |
| Iapetus | æ¸…æ™° | Erinome | æ¸…æ™° |
| Algieba | æµç•… | Despina | æµç•… |
| Leda | å¹´è½» | Aoede | è½»å¿« |
| Enceladus | æ°”å£° | Algenib | æ²™å“‘ |
| Achernar | æŸ”å’Œ | Schedar | å¹³ç¨³ |
| Gacrux | æˆç†Ÿ | Pulcherrima | ç›´æ¥ |
| Achird | å‹å¥½ | Zubenelgenubi | éšæ„ |
| Vindemiatrix | æ¸©å’Œ | Sadachbia | æ´»æ³¼ |
| Sadaltager | åšå­¦ | Sulafat | æ¸©æš– |

### æ”¯æŒçš„è¯­è¨€ï¼ˆ24ç§ï¼‰

- ä¸­æ–‡ (zh-CN)
- è‹±è¯­ (en-US, en-IN)
- æ—¥è¯­ (ja-JP)
- éŸ©è¯­ (ko-KR)
- æ³•è¯­ (fr-FR)
- å¾·è¯­ (de-DE)
- è¥¿ç­ç‰™è¯­ (es-US)
- æ„å¤§åˆ©è¯­ (it-IT)
- è‘¡è„ç‰™è¯­ (pt-BR)
- ä¿„è¯­ (ru-RU)
- é˜¿æ‹‰ä¼¯è¯­ (ar-EG)
- å°åœ°è¯­ (hi-IN)
- å°å°¼è¯­ (id-ID)
- è·å…°è¯­ (nl-NL)
- æ³¢å…°è¯­ (pl-PL)
- æ³°è¯­ (th-TH)
- åœŸè€³å…¶è¯­ (tr-TR)
- è¶Šå—è¯­ (vi-VN)
- ç½—é©¬å°¼äºšè¯­ (ro-RO)
- ä¹Œå…‹å…°è¯­ (uk-UA)
- å­ŸåŠ æ‹‰è¯­ (bn-BD)
- é©¬æ‹‰åœ°è¯­ (mr-IN)
- æ³°ç±³å°”è¯­ (ta-IN)
- æ³°å¢å›ºè¯­ (te-IN)

## æ€§èƒ½æŒ‡æ ‡

### Gemini vs Qwen

| æŒ‡æ ‡ | Qwen | Gemini | æ”¹è¿› |
|------|------|--------|------|
| éŸ³è‰²æ•°é‡ | 17 | 30 | +76% |
| æœ€å¤§è¾“å…¥ | 600 å­—ç¬¦ | 32k tokens | +53x |
| å“åº”æ—¶é—´ | 3-8ç§’ | 2-4ç§’ | -50% |
| HTTP è¯·æ±‚ | 2 æ¬¡ | 1 æ¬¡ | -50% |
| é€Ÿç‡é™åˆ¶ | 10/åˆ†é’Ÿ | æ›´å®½æ¾ | æ›´å¥½ |

### éŸ³é¢‘è´¨é‡
- **é‡‡æ ·ç‡**: 24kHz
- **ä½æ·±**: 16-bit
- **å£°é“**: å•å£°é“
- **æ ¼å¼**: PCM â†’ WAV

## å·²çŸ¥é—®é¢˜

### 1. ä¸æ˜¯çœŸæ­£çš„æµå¼æ’­æ”¾
- **ç°çŠ¶**: Gemini è¿”å›å®Œæ•´éŸ³é¢‘æ•°æ®ï¼Œä¸æ˜¯é€å—ç”Ÿæˆ
- **å½±å“**: é•¿æ–‡æœ¬éœ€è¦ç­‰å¾…å®Œæ•´ç”Ÿæˆ
- **è§£å†³æ–¹æ¡ˆ**: åœ¨ TTSService ä¸­åˆ†å—å¤„ç†é•¿æ–‡æœ¬

### 2. éŸ³è‰²åç§°ä¸å…¼å®¹
- **ç°çŠ¶**: Qwen éŸ³è‰²ï¼ˆå¦‚ Cherryï¼‰åœ¨ Gemini ä¸­ä¸å­˜åœ¨
- **å½±å“**: ç”¨æˆ·åå¥½éœ€è¦é‡æ–°é€‰æ‹©
- **è§£å†³æ–¹æ¡ˆ**: è‡ªåŠ¨å›é€€åˆ°é»˜è®¤éŸ³è‰² Kore

### 3. ç¼“å­˜é”®å˜åŒ–
- **ç°çŠ¶**: éŸ³è‰²åç§°å˜åŒ–å¯¼è‡´ç¼“å­˜é”®ä¸åŒ
- **å½±å“**: æ—§ç¼“å­˜æ— æ³•ä½¿ç”¨
- **è§£å†³æ–¹æ¡ˆ**: è‡ªåŠ¨ç”Ÿæˆæ–°ç¼“å­˜

## ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆæœ¬å‘¨ï¼‰
1. âœ… ä¿®å¤æµå¼æ’­æ”¾é—®é¢˜
2. âœ… è¿ç§»åˆ° Gemini TTS
3. â³ è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
4. â³ æ€§èƒ½ä¼˜åŒ–

### ä¸­æœŸï¼ˆæœ¬æœˆï¼‰
1. å®ç°çœŸæ­£çš„æµå¼æ’­æ”¾ï¼ˆåˆ†å—å¤„ç†ï¼‰
2. æ·»åŠ æ›´å¤šéŸ³è‰²é¢„è§ˆåŠŸèƒ½
3. ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
4. æ”¹è¿›é”™è¯¯å¤„ç†

### é•¿æœŸï¼ˆæœªæ¥ï¼‰
1. æ”¯æŒå¤šè¯´è¯äººï¼ˆGemini æ”¯æŒï¼‰
2. æ·»åŠ è¯­éŸ³é£æ ¼æ§åˆ¶ï¼ˆé€šè¿‡æç¤ºè¯ï¼‰
3. å®ç°éŸ³é¢‘ç¼–è¾‘åŠŸèƒ½
4. æ”¯æŒç¦»çº¿æ’­æ”¾

## å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£
- [Gemini TTS API æ–‡æ¡£](https://ai.google.dev/gemini-api/docs/speech-generation)
- [Web Audio API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API)
- [Server-Sent Events](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events)

### é¡¹ç›®æ–‡æ¡£
- [è®¾è®¡æ–‡æ¡£](./design.md)
- [éœ€æ±‚æ–‡æ¡£](./requirements.md)
- [ä»»åŠ¡åˆ—è¡¨](./tasks.md)

## è´¡çŒ®è€…

- **å¼€å‘**: Kiro AI Assistant
- **éœ€æ±‚**: ç”¨æˆ·
- **æµ‹è¯•**: å¾…è¿›è¡Œ

## æ›´æ–°æ—¥å¿—

### 2025-11-20
- âœ… ä¿®å¤æµå¼æ’­æ”¾é—®é¢˜
- âœ… ä» Qwen è¿ç§»åˆ° Gemini TTS
- âœ… æ›´æ–°éŸ³è‰²åˆ—è¡¨ï¼ˆ30ç§ï¼‰
- âœ… åˆ›å»ºæµ‹è¯•è„šæœ¬
- âœ… ç¼–å†™è¿ç§»æ–‡æ¡£

### 2025-11-19
- âœ… å®Œæˆæ ¸å¿ƒåŠŸèƒ½å®ç°ï¼ˆä»»åŠ¡ 1-10ï¼‰
- âœ… é›†æˆåˆ° ReadingView
- âœ… å®ç°éŸ³é¢‘ç¼“å­˜

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ–‡æ¡£ç›®å½•ä¸­çš„ç›¸å…³æ–‡æ¡£
2. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
3. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æ’æŸ¥é—®é¢˜

---

**çŠ¶æ€**: ğŸŸ¢ æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼Œå¾…æµ‹è¯•å’Œä¼˜åŒ–
**æœ€åæ›´æ–°**: 2025-11-20
