<!DOCTYPE html>
<html lang="zh-CN" class="h-full">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>reinvent Insight - 深度分析笔记</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/marked/marked.min.js"></script>
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.min.css">
      <!-- 注意：生产环境应使用PostCSS插件或Tailwind CLI -->
    <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body class="h-full">
  <div id="app" class="h-full flex flex-col bg-gray-900 text-gray-200">
    <!-- ======================================================================= -->
    <!--                                 Header                                  -->
    <!-- ======================================================================= -->
    <header v-if="currentView !== 'read' && !isShareView"
      class="tech-gradient border-b border-gray-800 shadow-lg sticky top-0 z-40">
      <div class="max-w-full mx-auto px-4 py-4 md:flex md:items-center md:justify-between mobile-header">
        <div class="flex items-center justify-between w-full md:w-auto">
          <div class="flex items-center space-x-4">
            <a href="/" @click.prevent="goHome" class="cursor-pointer">
              <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
                reinvent <span class="text-purple-400">Insight</span>
              </h1>
            </a>
            <div v-if="isAuthenticated" class="hidden md:flex space-x-2">
              <button @click="currentView = 'create'" class="tech-btn tech-btn-secondary">创建深度解读</button>
              <button @click="currentView = 'library'" class="tech-btn tech-btn-secondary">浏览笔记库</button>
            </div>
          </div>
          <div class="md:hidden">
            <button v-if="!isAuthenticated" @click="showLogin = true" class="tech-btn tech-btn-secondary">登录</button>
            <button v-else @click="logout" class="tech-btn tech-btn-danger">退出</button>
          </div>
        </div>
        <div v-if="isAuthenticated" class="md:hidden mobile-nav flex gap-2 mt-3">
          <button @click="currentView = 'create'" class="tech-btn tech-btn-secondary flex-1">创建深度解读</button>
          <button @click="currentView = 'library'" class="tech-btn tech-btn-secondary flex-1">浏览笔记库</button>
        </div>
        <div class="hidden md:flex items-center space-x-4">
          <button v-if="!isAuthenticated" @click="showLogin = true" class="tech-btn tech-btn-primary">登录</button>
          <button v-else @click="logout" class="tech-btn tech-btn-danger">退出</button>
        </div>
      </div>
    </header>

    <header v-if="currentView === 'read'"
      class="tech-gradient border-b border-gray-800 shadow-lg sticky top-0 z-40 mobile-reading-header">
      <div class="max-w-full mx-auto px-4 py-3 flex items-center justify-between header-content">
        <div class="flex items-center space-x-4">
          <a href="/" @click.prevent="goHome" class="cursor-pointer">
            <h1 class="text-xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
              reinvent <span class="text-purple-400">Insight</span>
            </h1>
          </a>

          <!-- PC端紧贴品牌标识的按钮组 -->
          <div class="hidden md:flex reading-controls">
            <!-- 返回按钮 -->
            <button @click="goBackToLibrary" v-if="!isShareView" class="tech-btn tech-btn-secondary">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18">
                </path>
              </svg>
              返回笔记库
            </button>

            <!-- 观看原视频按钮 -->
            <button v-if="readingVideoUrl" @click="openVideoPlayer" class="tech-btn tech-btn-secondary">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
              观看原视频
            </button>

            <!-- 下载PDF按钮 -->
            <button @click="downloadPDF" class="tech-btn tech-btn-secondary" :disabled="pdfDownloading">
              <svg v-if="!pdfDownloading" class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
              <svg v-else class="w-4 h-4 mr-1 animate-spin" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              {{ pdfDownloading ? '生成中...' : '下载PDF' }}
            </button>

            <!-- 目录切换按钮 -->
            <button @click="toggleToc" class="tech-btn tech-btn-secondary mobile-hide-toc-btn"
              :title="showToc ? '隐藏目录' : '显示目录'">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  :d="showToc ? 'M6 18L18 6M6 6l12 12' : 'M4 6h16M4 12h16M4 18h7'"></path>
              </svg>
              {{ showToc ? '隐藏目录' : '显示目录' }}
            </button>
          </div>
        </div>

        <!-- 移动端按钮组 -->
        <div class="md:hidden flex items-center space-x-2">
          <!-- 返回按钮 -->
          <button @click="goBackToLibrary" v-if="!isShareView" class="tech-btn tech-btn-secondary mobile-back-btn">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18">
              </path>
            </svg>
            返回
          </button>
        </div>
      </div>
    </header>

    <!-- ======================================================================= -->
    <!--                               App Content                               -->
    <!-- ======================================================================= -->
    <div class="flex-1" :class="{'overflow-auto': currentView !== 'read', 'overflow-y-hidden': currentView === 'read'}">
      <!-- ##### HERO SECTION ##### -->
      <div v-if="showHeroSection" class="relative text-white text-center py-20 px-6 overflow-hidden">
        <div class="absolute inset-0 bg-gray-900 bg-opacity-60 backdrop-blur-sm"></div>
        <div class="absolute inset-0 z-0 opacity-20"
          style="background-image: url('https://www.transparenttextures.com/patterns/cubes.png'), linear-gradient(to right bottom, #051937, #004d7a, #008793, #00bf72, #a8eb12); background-size: auto, cover;">
        </div>
        <div class="relative z-10">
          <h1 class="text-5xl md:text-6xl font-extrabold mb-4 leading-tight"><span
              class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">与顶尖架构师</span><span
              class="block md:inline">思维同步</span></h1>
          <p class="text-xl md:text-2xl max-w-3xl mx-auto text-gray-300 mb-8">洞悉架构取舍，解码设计精髓。行业最前沿思考,云计算必读洞见。</p>
          <button v-if="!isAuthenticated" @click="showLogin = true"
            class="tech-btn tech-btn-primary tech-btn-lg text-lg px-8 py-4">即刻登录，开启洞察之旅</button>
        </div>
      </div>
      <!-- ##### Logged-in User View ##### -->
      <div v-if="isAuthenticated">
        <!-- Create View -->
        <div v-if="currentView === 'create' && !isShareView" class="max-w-4xl mx-auto p-6 fade-in mobile-container">
          <!-- Input Card -->
          <div
            class="tech-gradient border border-gray-700 rounded-xl p-8 shadow-2xl mb-8 glow-effect mobile-input-card">
            <div class="text-center mb-6">
              <h2
                class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-br from-amber-600 to-orange-700 mb-2">
                reInvent Insights </h2>
              <p class="text-gray-400">输入 YouTube 链接，获得深度解读</p>
            </div>

            <div class="space-y-4">
              <div>
                <!-- <label class="block text-sm font-medium mb-2 text-cyan-400">YouTube 视频链接</label> -->
                <input v-model="url" @keyup.enter="startSummarize" :disabled="loading" type="url"
                  placeholder="https://www.youtube.com/watch?v=..."
                  class="w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent disabled:opacity-50 transition-all" />
              </div>

              <button :disabled="loading || !url || !isValidYoutubeUrl(url)" @click="startSummarize"
                class="w-full tech-btn tech-btn-secondary">
                <span v-if="!loading" class="flex items-center justify-center">
                  <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M13 10V3L4 14h7v7l9-11h-7z">
                    </path>
                  </svg>
                  开始分析
                </span>
                <span v-else class="flex items-center justify-center">
                  <svg class="w-5 h-5 mr-2 animate-spin" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor"
                      d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                    </path>
                  </svg>
                  AI 分析中...
                </span>
              </button>
            </div>
          </div>

          <!-- Progress & Logs -->
          <div v-if="loading || logs.length"
            class="bg-gray-900/50 border border-gray-700 rounded-xl p-6 shadow-xl mb-8 backdrop-blur-sm mobile-progress">
            <!-- 进度条 -->
            <div class="w-full h-2 bg-gray-800 rounded-full overflow-hidden mb-4">
              <div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 transition-all duration-300"
                :style="{ width: progressPercent + '%' }"></div>
            </div>
            <h3 class="text-xl font-semibold mb-4 text-cyan-400 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
              </svg>
              处理进度
            </h3>
            <div class="space-y-2">
              <div v-for="(log, index) in logs" :key="index" class="flex items-center text-sm slide-in">
                <div class="w-2 h-2 bg-green-500 rounded-full mr-3 flex-shrink-0"></div>
                <span class="text-gray-300">{{ log }}</span>
              </div>
              <div v-if="loading && currentStep < totalSteps" class="flex items-center text-sm text-gray-400">
                <div class="w-2 h-2 bg-cyan-500 rounded-full mr-3 animate-pulse flex-shrink-0"></div>
                <span>AI 正在处理，请稍候...</span>
              </div>
            </div>
          </div>

          <!-- Result -->
          <div v-if="summary" class="fade-in">
            <div class="bg-gray-900/30 border border-gray-700 rounded-xl p-8 shadow-2xl backdrop-blur-sm">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
                  {{ title }}
                </h2>
                <button @click="viewSummary(title, summary)"
                  class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 rounded-lg text-white font-medium transition-all duration-200 transform hover:scale-105">
                  全屏阅读
                </button>
              </div>
              <div v-html="rendered" class="prose-tech"></div>
            </div>
          </div>
        </div>
        <!-- Library View -->
        <div v-if="currentView === 'library' && !isShareView" class="max-w-6xl mx-auto p-6 fade-in mobile-container">
          <div class="mb-8">
            <h2
              class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 mb-2">
              笔记库</h2>
            <p class="text-gray-400">浏览深度分析笔记</p>
          </div>
          <div v-if="libraryLoading" class="flex items-center justify-center py-12">
            <div class="text-center">
              <svg class="w-8 h-8 animate-spin text-cyan-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
              </svg>
              <p class="text-gray-400">加载笔记中...</p>
            </div>
          </div>
          <div v-else-if="summaries.length > 0" class="space-y-12">
            <!-- REINVENT CARDS -->
            <div v-if="categorizedSummaries.reinvent.length > 0" class="section-container">
              <div class="flex items-center mb-6 section-header">
                <div class="flex items-center">
                  <div class="w-3 h-3 bg-gradient-to-r from-orange-500 to-red-600 rounded-full mr-3 glow-effect"></div>
                  <h3
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500">
                    AWS re:Invent 深度解读</h3>
                  <span class="article-count ml-3">{{ filteredReinventSummaries.length }} 篇</span>
                </div>
                <div class="ml-auto flex items-center space-x-3">
                  <!-- 课程级别筛选器 -->
                  <div class="custom-dropdown" :class="{ active: showLevelDropdown }">
                    <div @click="toggleLevelDropdown" class="custom-dropdown-trigger">
                      <span>{{ selectedLevel ? (selectedLevel === 'Keynote' ? 'Keynote' : selectedLevel + ' 级') : '全部级别' }}</span>
                    </div>
                    <div class="custom-dropdown-menu">
                      <div @click="selectLevel('')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '' }">
                        全部级别
                      </div>
                      <div @click="selectLevel('100')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '100' }">
                        100-基础
                      </div>
                      <div @click="selectLevel('200')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '200' }">
                        200-中级
                      </div>
                      <div @click="selectLevel('300')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '300' }">
                        300-高级
                      </div>
                      <div @click="selectLevel('400')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '400' }">
                        400-专家
                      </div>
                      <div @click="selectLevel('Keynote')" class="custom-dropdown-option" :class="{ selected: selectedLevel === 'Keynote' }">
                        Keynote演讲
                      </div>
                    </div>
                  </div>
                  <!-- 年份筛选器 -->
                  <div class="custom-dropdown" :class="{ active: showYearDropdown }">
                    <div @click="toggleYearDropdown" class="custom-dropdown-trigger">
                      <span>{{ selectedYear || '全部年份' }}</span>
                    </div>
                    <div class="custom-dropdown-menu">
                      <div @click="selectYear('')" class="custom-dropdown-option" :class="{ selected: selectedYear === '' }">
                        全部年份
                      </div>
                      <div v-for="year in availableYears" :key="year" 
                           @click="selectYear(year)" 
                           class="custom-dropdown-option" 
                           :class="{ selected: selectedYear === year }">
                        {{ year }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mobile-grid">
                <div v-for="summary in filteredReinventSummaries" :key="summary.filename"
                  class="summary-card tech-gradient border border-orange-700/50 rounded-xl p-6 transition-all duration-200 glow-effect group flex flex-col justify-between h-64 reinvent-card relative">

                  <!-- Main clickable area -->
                  <div @click="loadSummaryByHash(summary.hash)" class="cursor-pointer flex-grow flex flex-col">
                    <div class="mb-3 chinese-title-container">
                        <h3 class="text-base font-bold leading-snug line-clamp-3 chinese-title text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 group-hover:text-white group-hover:bg-none" :title="summary.title_cn">{{ summary.title_cn }}</h3>
                    </div>
                    <div class="flex-1 mb-2 english-title-area">
                        <p class="text-xs text-orange-400/90 group-hover:text-white/90 transition-colors font-normal leading-relaxed break-words w-full english-subtitle" :title="summary.title_en">{{ summary.title_en }}</p>
                    </div>
                  </div>

                  <!-- Footer with metadata and links -->
                  <div class="metadata-footer border-t border-orange-700/30 pt-3 text-xs text-orange-400 group-hover:text-white/80 transition-colors">
                      <div class="flex justify-between items-center">
                          <div class="flex items-center space-x-3">
                              <div class="flex items-center" title="字数"><svg class="w-3.5 h-3.5 mr-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>{{ formatWordCount(summary.word_count || summary.size) }}</span></div>
                          </div>
                          <div class="flex items-center space-x-2">
                              <div class="metadata-badge">re:Invent</div>
                              <div class="metadata-badge">{{ (summary.title_en && summary.title_en.match(/\b(20\d{2})\b/)) ? summary.title_en.match(/\b(20\d{2})\b/)[1] : (summary.upload_date ? summary.upload_date.substring(0,4) : '') }}</div>
                              <div v-if="summary.level" class="level-badge" :class="'level-' + (summary.level.match(/\d+/) ? summary.level.match(/\d+/)[0] : '100')">{{ summary.level.split(' - ')[0] }}</div>
                          </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- OTHER CARDS -->
            <div v-if="categorizedSummaries.other.length > 0" class="section-container">
              <div class="flex items-center mb-6 section-header">
                <div class="flex items-center">
                  <div class="w-3 h-3 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full mr-3 glow-effect"></div>
                  <h3
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
                    其他精选内容</h3>
                  <span class="article-count ml-3">{{ categorizedSummaries.other.length }} 篇</span>
                </div>
              </div>
              <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mobile-grid">
                <div v-for="summary in categorizedSummaries.other" :key="summary.filename"
                  @click="loadSummaryByHash(summary.hash)"
                  class="summary-card tech-gradient border border-gray-700 rounded-xl p-6 cursor-pointer hover:border-cyan-500 transition-all duration-200 glow-effect group flex flex-col h-56 other-card relative">
                  <div class="mb-3 chinese-title-container">
                    <h3
                      class="text-base font-bold leading-snug line-clamp-3 chinese-title text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 group-hover:text-white group-hover:bg-none"
                      :title="summary.title_cn">{{ summary.title_cn }}</h3>
                  </div>
                  <div class="flex-1 mb-2 english-title-area">
                    <p class="text-xs text-cyan-400/90 group-hover:text-white/90 transition-colors font-normal leading-relaxed break-words w-full english-subtitle"
                      :title="summary.title_en">{{ summary.title_en }}</p>
                  </div>
                  <div
                    class="metadata-area border-gray-700/50 text-xs text-cyan-500 group-hover:text-white/80 transition-colors">
                    <div class="flex justify-between items-center">
                      <div class="flex items-center space-x-3">
                        <div class="flex items-center"><svg class="w-3.5 h-3.5 mr-1 flex-shrink-0" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                            </path>
                          </svg><span>{{ formatWordCount(summary.word_count || summary.size) }}</span></div>
                      </div>
                      <div class="flex items-center space-x-2">
                        <div class="metadata-badge">精选</div>
                        <div v-if="summary.level" class="level-badge" :class="'level-' + (summary.level.match(/\d+/) ? summary.level.match(/\d+/)[0] : '100')">{{ summary.level.split(' - ')[0] }}</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div v-else class="text-center py-12">
            <h3 class="text-xl font-semibold text-gray-300">笔记库为空</h3>
            <p class="text-gray-500 mt-2">创建您的第一篇深度解读笔记吧！</p>
          </div>
        </div>

      </div>

      <!-- ##### Public Visitor View ##### -->
      <div v-else-if="!isShareView && currentView !== 'read'">
        <div class="max-w-6xl mx-auto p-6 mobile-container">
          <div class="mb-8 text-center">
            <h2
              class="text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-500 mb-2">
            </h2>
          </div>
          <div v-if="libraryLoading" class="flex items-center justify-center py-12">
            <div class="text-center">
              <svg class="w-8 h-8 animate-spin text-cyan-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor"
                  d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
                </path>
              </svg>
              <p class="text-gray-400">加载洞察中...</p>
            </div>
          </div>
          <div v-else-if="summaries.length > 0" class="space-y-12">
            <!-- REINVENT CARDS -->
            <div v-if="categorizedSummaries.reinvent.length > 0" class="section-container">
              <div class="flex items-center mb-6 section-header">
                <div class="flex items-center">
                  <div class="w-3 h-3 bg-gradient-to-r from-orange-500 to-red-600 rounded-full mr-3 glow-effect"></div>
                  <h3
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500">
                    AWS re:Invent 深度解读</h3>
                  <span class="article-count ml-3">{{ filteredReinventSummaries.length }} 篇</span>
                </div>
                <div class="ml-auto flex items-center space-x-3">
                  <!-- 课程级别筛选器 -->
                  <div class="custom-dropdown" :class="{ active: showLevelDropdown }">
                    <div @click="toggleLevelDropdown" class="custom-dropdown-trigger">
                      <span>{{ selectedLevel ? (selectedLevel === 'Keynote' ? 'Keynote' : selectedLevel + ' 级') : '全部级别' }}</span>
                    </div>
                    <div class="custom-dropdown-menu">
                      <div @click="selectLevel('')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '' }">
                        全部级别
                      </div>
                      <div @click="selectLevel('100')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '100' }">
                        100-基础
                      </div>
                      <div @click="selectLevel('200')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '200' }">
                        200-中级
                      </div>
                      <div @click="selectLevel('300')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '300' }">
                        300-高级
                      </div>
                      <div @click="selectLevel('400')" class="custom-dropdown-option" :class="{ selected: selectedLevel === '400' }">
                        400-专家
                      </div>
                      <div @click="selectLevel('Keynote')" class="custom-dropdown-option" :class="{ selected: selectedLevel === 'Keynote' }">
                        Keynote演讲
                      </div>
                    </div>
                  </div>
                  <!-- 年份筛选器 -->
                  <div class="custom-dropdown" :class="{ active: showYearDropdown }">
                    <div @click="toggleYearDropdown" class="custom-dropdown-trigger">
                      <span>{{ selectedYear || '全部年份' }}</span>
                    </div>
                    <div class="custom-dropdown-menu">
                      <div @click="selectYear('')" class="custom-dropdown-option" :class="{ selected: selectedYear === '' }">
                        全部年份
                      </div>
                      <div v-for="year in availableYears" :key="year" 
                           @click="selectYear(year)" 
                           class="custom-dropdown-option" 
                           :class="{ selected: selectedYear === year }">
                        {{ year }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mobile-grid">
                <div v-for="summary in filteredReinventSummaries" :key="summary.filename"
                  class="summary-card tech-gradient border border-orange-700/50 rounded-xl p-6 transition-all duration-200 glow-effect group flex flex-col justify-between h-64 reinvent-card relative">

                  <!-- Main clickable area -->
                  <div @click="loadSummaryByHash(summary.hash)" class="cursor-pointer flex-grow flex flex-col">
                    <div class="mb-3 chinese-title-container">
                        <h3 class="text-base font-bold leading-snug line-clamp-3 chinese-title text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-red-500 group-hover:text-white group-hover:bg-none" :title="summary.title_cn">{{ summary.title_cn }}</h3>
                    </div>
                    <div class="flex-1 mb-2 english-title-area">
                        <p class="text-xs text-orange-400/90 group-hover:text-white/90 transition-colors font-normal leading-relaxed break-words w-full english-subtitle" :title="summary.title_en">{{ summary.title_en }}</p>
                    </div>
                  </div>

                  <!-- Footer with metadata and links -->
                  <div class="metadata-footer border-t border-orange-700/30 pt-3 text-xs text-orange-400 group-hover:text-white/80 transition-colors">
                      <div class="flex justify-between items-center">
                          <div class="flex items-center space-x-3">
                              <div class="flex items-center" title="字数"><svg class="w-3.5 h-3.5 mr-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span>{{ formatWordCount(summary.word_count || summary.size) }}</span></div>
                          </div>
                          <div class="flex items-center space-x-2">
                              <div class="metadata-badge">re:Invent</div>
                              <div class="metadata-badge">{{ (summary.title_en && summary.title_en.match(/\b(20\d{2})\b/)) ? summary.title_en.match(/\b(20\d{2})\b/)[1] : (summary.upload_date ? summary.upload_date.substring(0,4) : '') }}</div>
                              <div v-if="summary.level" class="level-badge" :class="'level-' + (summary.level.match(/\d+/) ? summary.level.match(/\d+/)[0] : '100')">{{ summary.level.split(' - ')[0] }}</div>
                          </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- OTHER CARDS -->
            <div v-if="categorizedSummaries.other.length > 0" class="section-container">
              <div class="flex items-center mb-6 section-header">
                <div class="flex items-center">
                  <div class="w-3 h-3 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full mr-3 glow-effect"></div>
                  <h3
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">
                    其他精选内容</h3>
                  <span class="article-count ml-3">{{ categorizedSummaries.other.length }} 篇</span>
                </div>
              </div>
              <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mobile-grid">
                <div v-for="summary in categorizedSummaries.other" :key="summary.filename"
                  @click="loadSummaryByHash(summary.hash)"
                  class="summary-card tech-gradient border border-gray-700 rounded-xl p-6 cursor-pointer hover:border-cyan-500 transition-all duration-200 glow-effect group flex flex-col h-56 other-card relative">
                  <div class="mb-3 chinese-title-container">
                    <h3
                      class="text-base font-bold leading-snug line-clamp-3 chinese-title text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 group-hover:text-white group-hover:bg-none"
                      :title="summary.title_cn">{{ summary.title_cn }}</h3>
                  </div>
                  <div class="flex-1 mb-2 english-title-area">
                    <p class="text-xs text-cyan-400/90 group-hover:text-white/90 transition-colors font-normal leading-relaxed break-words w-full english-subtitle"
                      :title="summary.title_en">{{ summary.title_en }}</p>
                  </div>
                  <div
                    class="metadata-area border-gray-700/50 text-xs text-cyan-500 group-hover:text-white/80 transition-colors">
                    <div class="flex justify-between items-center">
                      <div class="flex items-center space-x-3">
                        <div class="flex items-center"><svg class="w-3.5 h-3.5 mr-1 flex-shrink-0" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                            </path>
                          </svg><span>{{ formatWordCount(summary.word_count || summary.size) }}</span></div>
                      </div>
                      <div class="flex items-center space-x-2">
                        <div class="metadata-badge">精选</div>
                        <div v-if="summary.level" class="level-badge" :class="'level-' + (summary.level.match(/\d+/) ? summary.level.match(/\d+/)[0] : '100')">{{ summary.level.split(' - ')[0] }}</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div v-else class="text-center py-12">
            <h3 class="text-xl font-semibold text-gray-300">暂无公开内容</h3>
            <p class="text-gray-500 mt-2">敬请期待更多深度解读！</p>
          </div>
        </div>
      </div>

      <!-- ##### Universal Reading View ##### -->
      <div v-if="currentView === 'read'" class="h-full fade-in mobile-reading-content">
        <div v-if="readingError" class="flex items-center justify-center h-full text-red-400">
          {{ readingError }}
        </div>
        <div v-else class="flex h-full mobile-reading">
          <!-- TOC Sidebar -->
          <div v-if="showToc" :style="{ width: tocWidth + 'px' }"
            class="relative toc-sidebar flex-shrink-0 h-full border-r border-gray-800 mobile-hide-toc overflow-y-auto py-8">
            <div class="px-6 h-full">
              <div class="toc h-full">
                <h3 class="text-lg font-bold text-cyan-400">目录</h3>
                <div v-html="tocHtml" @click="handleTocClick" class="mt-4"></div>
              </div>
            </div>
          </div>
          <!-- Drag Bar -->
          <div v-if="showToc" class="dragbar h-full" @mousedown="initDrag"></div>
          <!-- Article -->
          <div class="flex-1 min-w-0 h-full overflow-y-auto" :class="{ 'no-toc-centered': !showToc }">
            <div class="max-w-none px-4 py-8">
              <div v-if="readingContent" @click="handleArticleClick"
                class="tech-gradient border border-gray-700 rounded-xl p-10 shadow-2xl backdrop-blur-sm">
                <div v-html="readingContent" class="prose-tech max-w-none"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ======================================================================= -->
    <!--                           Modals and Toasts                             -->
    <!-- ======================================================================= -->
    <!-- 浮动视频播放器 -->
    <div v-if="showVideoPlayer" 
         class="floating-video-player" 
         :class="{ minimized: videoPlayerMinimized, resizing: isVideoResizing, dragging: isVideoDragging }"
         :style="{
           left: videoPlayerPosition.x !== null ? videoPlayerPosition.x + 'px' : 'auto',
           top: videoPlayerPosition.y !== null ? videoPlayerPosition.y + 'px' : 'auto',
           right: videoPlayerPosition.x !== null ? 'auto' : '20px',
           bottom: videoPlayerPosition.y !== null ? 'auto' : '20px',
           width: videoPlayerMinimized ? '300px' : videoPlayerSize.width + 'px',
           height: videoPlayerMinimized ? 'auto' : videoPlayerSize.height + 'px'
         }">
      <div class="video-player-header" @mousedown="startVideoDrag" @touchstart="startVideoDrag" @dblclick="toggleVideoPlayerMinimize" title="拖动移动位置，双击最小化">
        <div class="video-player-title">{{ currentVideoTitle }}</div>
        <div class="video-player-controls">
          <button @click="toggleVideoPlayerMinimize" class="video-control-btn" :title="videoPlayerMinimized ? '恢复' : '最小化'">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path v-if="!videoPlayerMinimized" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
              <path v-else stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
            </svg>
          </button>
          <button @click="closeVideoPlayer" class="video-control-btn" title="关闭">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
      <div v-show="!videoPlayerMinimized" class="video-player-content">
        <iframe 
          :src="`https://www.youtube.com/embed/${currentVideoId}?enablejsapi=1&modestbranding=1&rel=0`"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>
      </div>
      <div v-show="!videoPlayerMinimized" class="resize-handle" @mousedown="startVideoResize"></div>
    </div>

    <transition name="fade">
      <div v-if="showLogin" class="modal inset-0 fixed bg-black/70 z-50 flex items-center justify-center">
        <div
          class="tech-gradient border border-gray-700 rounded-xl p-8 shadow-2xl glow-effect relative max-w-sm w-full m-4">
          <button @click="showLogin = false" class="absolute top-4 right-4 text-gray-500 hover:text-white">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
          <h2 class="text-2xl font-bold text-center text-cyan-400 mb-6">用户登录</h2>
          <form @submit.prevent="login" class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2 text-cyan-400">用户名</label>
              <input v-model="loginUsername" type="text" required
                class="w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all" />
            </div>
            <div>
              <label class="block text-sm font-medium mb-2 text-cyan-400">密码</label>
              <input v-model="loginPassword" type="password" required
                class="w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all" />
            </div>
            <button type="submit" class="w-full tech-btn tech-btn-primary">
              登录
            </button>
          </form>
        </div>
      </div>
    </transition>
    <transition name="fade">
      <div v-if="toast.show" :class="{ '...': toast.type === '...'}" class="fixed ...">
        {{ toast.message }}
      </div>
    </transition>
  </div>
  <script src="/js/app.js?v=1.0.2"></script>
</body>

</html>