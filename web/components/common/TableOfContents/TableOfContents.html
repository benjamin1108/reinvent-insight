<div class="toc-container" v-if="visible">
  <!-- TOC 侧边栏 -->
  <div class="toc-sidebar" 
       :style="{ width: actualWidth + 'px' }"
       ref="tocSidebar">
    <div class="toc-content">
      <!-- 目录标题 -->
      <h3 class="toc-title">{{ title }}</h3>
      
      <!-- 调试信息 -->
      <div v-if="false" style="background: rgba(255,0,0,0.2); padding: 0.5rem; font-size: 0.75rem; margin-bottom: 1rem;">
        <div>sections length: {{ sections ? sections.length : 'null' }}</div>
        <div>useSectionsMode: {{ useSectionsMode }}</div>
        <div>tocHtml: {{ tocHtml ? 'has content' : 'empty' }}</div>
      </div>
      
      <!-- 目录内容 - sections模式 -->
      <div v-if="useSectionsMode" class="toc-list">
        <div v-for="section in sections" :key="section.id" 
             :class="['toc-section', { 'has-subsections': section.subsections && section.subsections.length > 0 }]">
          <a :href="`#${section.id}`"
             @click.prevent="handleNavigate(section.id)"
             :class="['toc-link', { 'active': isActive(section.id) }]">
            {{ section.title }}
          </a>
          
          <!-- 子章节 -->
          <div v-if="section.subsections && section.subsections.length > 0" 
               v-show="isExpanded(section.id)"
               class="toc-subsections">
            <a v-for="subsection in section.subsections"
               :key="subsection.id"
               :href="`#${subsection.id}`"
               @click.prevent="handleNavigate(subsection.id)"
               :class="['toc-link', 'toc-link-sub', { 'active': isActive(subsection.id) }]">
              {{ subsection.title }}
            </a>
          </div>
          
          <!-- 展开/折叠按钮 -->
          <button v-if="section.subsections && section.subsections.length > 0"
                  @click="toggleSection(section.id)"
                  class="toc-toggle"
                  :aria-expanded="isExpanded(section.id)">
            <span v-if="isExpanded(section.id)">▼</span>
            <span v-else>▶</span>
          </button>
        </div>
      </div>
      
      <!-- 目录内容 - HTML模式 -->
      <div v-else-if="tocHtml" 
           v-html="tocHtml" 
           @click="handleClick"
           class="toc-list"></div>
      
      <!-- 空目录提示 -->
      <div v-else class="toc-empty">
        {{ emptyText }}
      </div>
    </div>
  </div>
  
  <!-- 拖动条 -->
  <div class="toc-dragbar" 
       @mousedown="startDrag"
       @touchstart="startDrag"></div>
</div> 