/*
 * PDF Generation Stylesheet - 流暢優化版
 * 目的：最大限度減少不必要的頁底空白和空白頁，提升頁面連貫性。
 */

/* === PDF 頁面設定 === */
@page {
    size: A4;
    margin: 2.5cm 2cm;

    @bottom-left {
        content: element(pageFooter); /* 將 HTML 中定義的 footer 放在這裡 */
        vertical-align: top;
        padding-top: 5mm;
    }

    @bottom-right {
        content: "第 " counter(page) " 页";
        font-family: Helvetica, Arial, sans-serif;
        font-size: 9pt;
        font-weight: normal;
        color: #666;
        text-align: right;
        vertical-align: top;
        padding-top: 5mm;
    }
}

/* === 新增：HTML 頁腳樣式 === */
.page-footer {
    position: running(pageFooter); /* 定義這是一個可在頁眉/頁腳重複使用的元素 */
    font-family: Helvetica, Arial, sans-serif;
    font-size: 9pt;
    font-weight: bold;
}

.footer-reinvent {
    color: #06b6d4; /* 品牌主色調 - 青色 */
}

.footer-insight {
    color: #f59e0b; /* 品牌按鈕色 - 橙色 */
}

/* === 基礎元素樣式 === */
html, body {
    font-family: "Noto Serif SC", serif;
    font-size: 16px;
    line-height: 1.6;
    color: rgba(0,0,0,.85);
    margin: 0;
    padding: 0;
}

#nice { 
    text-align: justify;
    padding: 0;
}

/* === 標題 === */
#nice h1, #nice h2, #nice h3, #nice h4, #nice h5, #nice h6 {
    margin-top: 24px; /* 稍微減小上邊距 */
    margin-bottom: 15px;
    color: black;
    font-weight: 700;
    
    /* 關鍵規則：讓標題盡量和後面的內容待在一起，這是好的實踐，予以保留 */
    page-break-after: avoid; 
    
    page-break-before: auto; /* 允許瀏覽器在標題前自由換頁，但非強制 */
    page-break-inside: avoid; /* 保留，盡量避免標題自身被切斷 */
}

#nice h1 {
    font-size: 24px;
    color: #06b6d4; /* 主题色 */
}
#nice h2 { font-size: 22px; }
#nice h3 { font-size: 20px; }
#nice h4 { font-size: 18px; }
#nice h5 { font-size: 16px; }
#nice h6 { font-size: 16px; }

/* === 段落、列表和引用 === */
#nice p { 
    margin: 0; 
    padding: 8px 0; 
    line-height: 26px;
    /* 【優化一】: 將孤行寡行數從3降為2，給予排版引擎更大彈性 */
    orphans: 2;
    widows: 2;
} 

#nice ul, #nice ol { 
    margin: 8px 0;
    padding-left: 25px; 
    /* 【優化二 - 核心修改】: 移除此處的 page-break-inside: avoid; 
       允許長列表自然地跨頁，這是解決大段空白的最主要手段。 */
}
#nice ul { list-style-type: disc; }
#nice ul ul { list-style-type: square; }
#nice ol { list-style-type: decimal; }

#nice li {
    /* 將孤行寡行控制應用到列表項上 */
    orphans: 2;
    widows: 2;
}

#nice li section { 
    margin: 5px 0;
    line-height: 26px; 
    text-align: left;
} 

#nice blockquote { 
    display: block; 
    font-size: 0.9em; 
    border-left: 3px solid #06b6d4; /* 主题色 */
    background: rgba(6, 182, 212, 0.05); /* 主题色的浅色背景 */
    color: #37474f; /* 深灰色文本以保证可读性 */
    padding: 10px 20px;
    margin: 20px 0;
    page-break-inside: avoid; /* 對於引用，保留此規則通常是好的 */
} 
#nice blockquote p { 
    margin: 0; 
    padding: 0;
    line-height: 26px; 
}

/* === 連結 === */
#nice a { 
    color: #06b6d4; /* 主题色 */
    border-bottom: 1px solid #06b6d4; /* 主题色 */
    text-decoration: none; 
    font-weight: 700;
}
#nice a:hover {
    text-decoration: none;
    border-top: 1px solid #ddd;
}

/* === 其他元素 === */
#nice hr { 
    height: 1px; 
    margin: 15px 0;
    border: none; 
    border-top: 1px solid #ddd;
}

#nice code {
    font-family: SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;
}

#nice p code, #nice li section code { 
    font-size: 14px; 
    padding: 2px 4px; 
    border-radius: 4px; 
    margin: 0 2px; 
    color: #06b6d4; /* 主题色 */
    background-color: rgba(6, 182, 212, 0.1); /* 主题色的浅色背景 */
    font-family: SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;
}

#nice strong { 
    font-weight: 700;
}

/* H2 標題的特殊主題樣式 */
#nice h2 .content {
    display: inline-block;
    background: #06b6d4; /* 主题色 */
    color: #ffffff;
    padding: 3px 10px 1px;
    border-top-right-radius: 3px;
    border-top-left-radius: 3px;
    margin-right: 3px;
}
#nice h2:after {
   display: inline-block;
   content: " ";
   vertical-align: bottom;
   border-bottom: 22px solid #e0f7fa; /* 高度與字號匹配, 同样使用主题色的浅色背景 */
   border-right: 15px solid transparent;
}