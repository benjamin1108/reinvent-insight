# -*- coding: utf-8 -*-
"""
章节生成提示词模板
"""

# 章节生成约束模板（基于子章节结构）
CHAPTER_CONTENT_CONSTRAINT_TEMPLATE = """
## 当前章节生成要求

**子章节结构**（至少 3 个，根据内容可增加）：
{subsections_structure}

**必须包含的内容**：
{must_include_list}

**禁止涉及的内容**：
{must_exclude_list}

**内容指导**：
{content_guidance}

---

## 生成规则

1. **充分展开每个子章节**
   - 每个论点需有具体案例或数据支撑
   - 技术细节要解释清楚，不要一句话带过
   - 宁可写得详细，也不要为了简洁而省略重要内容

2. **基于原文事实**
   - 所有论述必须有原文支撑
   - 不要编造原文中没有的案例或数据

3. **避免重复**
   - 严格遵守"禁止涉及的内容"
   - 如需引用其他章节内容，使用"这一点在第X章已详细分析"

**提示**：如果某个论点内容特别丰富，可以拆分为多个段落深入展开
"""

# 步骤二：生成单个章节内容的提示词模板
CHAPTER_PROMPT_TEMPLATE = """
{role_and_style}

{base_prompt}

## 全局上下文
- **{content_type}**: {full_content}
- **完整大纲**: 
{full_outline}

{previous_chapters_context}

{chapter_content_constraint}

---
## 当前任务
你的任务是为上述 **完整大纲** 中的**特定一章**撰写详细内容。

**当前章节**：第 `{chapter_number}` 章 - `{current_chapter_title}`

请基于**{content_description}**提供的上下文，并理解当前章节在**完整大纲**中的位置，为其撰写深入、详尽的内容。

## 风格与一致性要求
- **风格统一**: 写作风格、专业口吻和分析深度必须与报告其他部分保持高度一致，把自己想象成正在撰写一部完整作品
- **参考上下文**: 审视上方的**完整大纲**，理解当前章节的承上启下作用
- **术语一致**: 确保专业术语与**原内容**和**基础提示词**中定义的标准保持一致

## 内容去重要求
{deduplication_instruction}

## 章节内容结构
禁止按照"摘要、论点、解读"的模版写作。请遵循以下叙事流向：

**Scene Setting（起）**：
- 用一个事实、一个数字或一个冲突直接把读者拽进场景
- 不要"在本章中，我们将探讨..."，直接给出最有冲击力的信息
- 画面感 > 概念定义

**Connect the Dots（承/转）**：
- 把离散的数据点连成线
- 解释它是如何从 A 推导到 B 的
- 展示因果链条，而非并列罗列

**Insight（合）**：
- 给出这章的"灵魂总结"
- 这不是复述，是透视——告诉读者"这意味着什么"
- 可以适当引入反面视角或未解决的问题

## 写作前的强制检查清单

**在开始写作前，请完成以下校准**：
1. ✅ 我将用纯中文写作，不在概念后加英文注释
2. ✅ 开场三句测试：写完开头三句后检查——这三句能否替换到任何一篇科技报道？如果能，重写
3. ✅ 我将直接切入内容，用画面和数据开场，不使用"上一章"、"演讲开场"等表达
4. ✅ 摩擦力检查：本章是否只写了成功？找出至少一个代价、质疑或挑战

## 输出要求
- **只输出**第 `{chapter_number}` 章 **'{current_chapter_title}'** 的完整内容
- **格式关键**：输出必须以 `### {chapter_number}. {current_chapter_title}` (Markdown H3 标题) 开头
- **直接切入核心**：标题后直接用事实、数据、观点开始正文，禁止使用以下开场方式：
  - ❌ "上一章我们谈到..."、"接下来我们将..."
  - ❌ "演讲开场"、"演讲伊始"、"在最开始"、"开篇"
  - ❌ "从...说起"、"首先让我们..."
  - ✅ 直接陈述核心内容，如直接给出关键观点、数据或案例
- **纯中文表达**：全文使用纯中文，不要在任何概念后添加括号英文注释
- **内容灵活性**：根据章节内容的深度灵活调整，如果内容本身比较浅显，无需强行输出所有三个部分
- **小标题使用**：必要时可以灵活制定小标题帮助阅读理解，但避免使用机械的"章节摘要"、"关键论点/数据/案例"、"深入解读"这类标题
- **范围限制**：不需要包含引言、总结、其他章节或任何无关的文字

{quality_control_rules}

---
**请开始撰写第 `{chapter_number}` 章 - `{current_chapter_title}` 的内容。**
"""
